<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<script>

 $(document).pjax('a[target!=_blank]', '#pageContent', {fragment: '#pageContent', timeout: 1500});


 function init(){
         new Valine({
          el: "#vcomments",
          app_id: "<%- theme.leancloud.app_id %>",
          app_key: "<%- theme.leancloud.app_key %>",
          path: window.location.pathname,
          avatar: "<%- theme.valine.avatar %>",
          placeholder: "<%- theme.valine.placeholder %>",
          recordIP: true,
        });
    if (typeof infoEle === "undefined" && infoEle === null) {
       const infoEle = document.querySelector("#vcomments .info");
           if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
             infoEle.childNodes.forEach(function (item) {
               item.parentNode.removeChild(item);
             });
           }

       }


         $(".nav-item-search").on("click", () => {
          let $searchWrap = $(".search-form-wrap"),
            isSearchAnim = false,
            searchAnimDuration = 200;

          const startSearchAnim = () => {
            isSearchAnim = true;
          };

          const stopSearchAnim = (callback) => {
            setTimeout(function () {
              isSearchAnim = false;
              callback && callback();
            }, searchAnimDuration);
          };

          $(".nav-item-search").on("click", () => {
            if (isSearchAnim) return;
            startSearchAnim();
            $searchWrap.addClass("on");
            stopSearchAnim(function () {
              $(".local-search-input").focus();
            });
          });
         });
     }

$(document).on('pjax:complete', function() {
    init();
})



</script>